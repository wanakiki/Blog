<!DOCTYPE html>
<html lang="zh-cn">
  <head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="robots" content="noodp"/>
  <meta name="author" content="Mogeko">
  <meta name="description" content="Mogeko 的个人博客">
  <meta name="keywords" content="blog, KMS, Hugo, GNU/Linux, Linux, Ubuntu, Rusty Lake: Roots, Hollow Knight, 空洞骑士">
  
  <link rel="prev" href="https://mogeko.me/2018/015/" />
  <link rel="next" href="https://mogeko.me/2018/017/" />
  <link rel="canonical" href="https://mogeko.me/2018/016/" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">
  <meta name="msapplication-TileColor" content="#da532c">
  <meta name="theme-color" content="#ffffff">
  <title>
       
       
           WSL 的安装与使用 | Mogeko`s Blog
       
  </title>
  <meta name="title" content="WSL 的安装与使用 | Mogeko`s Blog">
    
  
  <link rel="stylesheet" href="/font/iconfont.css">
  <link rel="stylesheet" href="/css/main.min.css">


  
  
 

<script type="application/ld+json">
 "@context" : "http://schema.org",
    "@type" : "BlogPosting",
    "mainEntityOfPage": {
         "@type": "WebPage",
         "@id": "https://mogeko.me"
    },
    "articleSection" : "posts",
    "name" : "WSL 的安装与使用",
    "headline" : "WSL 的安装与使用",
    "description" : "16 年 12 月份的时候，微软发布了 Windows Subsystem for Linux (WSL)，通过子系统的方式运行了一个完整的 Linux 系统。使得在 Windows 中使用 Linux 中的工具链成为可能。(Windows",
    "inLanguage" : "zh-cn",
    "author" : "Mogeko",
    "creator" : "Mogeko",
    "publisher": "Mogeko",
    "accountablePerson" : "Mogeko",
    "copyrightHolder" : "Mogeko",
    "copyrightYear" : "2018",
    "datePublished": "2018-06-04 00:00:00 &#43;0000 UTC",
    "dateModified" : "2018-06-04 00:00:00 &#43;0000 UTC",
    "url" : "https://mogeko.me/2018/016/",
    "wordCount" : "1695",
    "keywords" : [ "GNU/Linux","Ubuntu","Windows", "Mogeko`s Blog"]
}
</script>

  
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-104502658-2"></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'UA-104502658-2');
</script>

</head>

  


  <body class="">
    <div class="wrapper">
        <nav class="navbar">
    <div class="container">
        <div class="navbar-header header-logo">
        	<a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://mogeko.me">Mogeko`s Blog</a>
        </div>
        <div class="menu navbar-right">
                
                
                <a class="menu-item" href="/tools/" title="">Tools</a>
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                <a class="menu-item" href="/about/" title="Mogeko">Mogeko</a>
                
        </div>
    </div>
</nav>
<nav class="navbar-mobile" id="nav-mobile" style="display: none">
     <div class="container">
        <div class="navbar-header">
            <div>  <a href="javascript:void(0);" class="theme-switch"><i class="iconfont icon-xihuan"></i></a>&nbsp;<a href="https://mogeko.me">Mogeko`s Blog</a></div>
            <div class="menu-toggle">
                <span></span><span></span><span></span>
            </div>
        </div>
     
          <div class="menu" id="mobile-menu">
                
                
                <a class="menu-item" href="/tools/" title="">Tools</a>
                
                <a class="menu-item" href="/posts/" title="">Blog</a>
                
                <a class="menu-item" href="/categories/" title="">Categories</a>
                
                <a class="menu-item" href="/tags/" title="">Tags</a>
                
                <a class="menu-item" href="/about/" title="">About</a>
                
                <a class="menu-item" href="/about/" title="Mogeko">Mogeko</a>
                
        </div>
    </div>
</nav>
    	 <main class="main">
          <div class="container">
      		
<article class="post-warp" itemscope itemtype="http://schema.org/Article">
    <header class="post-header">
        <h1 class="post-title" itemprop="name headline">WSL 的安装与使用</h1>
        <div class="post-meta">
                Written by <a itemprop="name" href="https://mogeko.me" rel="author">Mogeko</a> with ♥ 
                <span class="post-time">
                on <time datetime=2018-06-04 itemprop="datePublished">June 4, 2018</time>
                </span>
                in
                <i class="iconfont icon-folder"></i>
                <span class="post-category">
                        <a href="https://mogeko.me/categories/%E5%85%B3%E4%BA%8E%E8%BD%AF%E4%BB%B6/"> 关于软件 </a>
                        
                </span>
                <span class="post-word-count">, 1695 words</span>
        </div>
    </header>
    <div class="post-content">
        

        
            
        

        
        
     
          
          
          

          
          
          

          

<p><img src="https://mogeko.github.io/images/016/logo.png"  alt="Logo"  style="border:0" /></p>

<p>16 年 12 月份的时候，微软发布了 Windows Subsystem for Linux (WSL)，通过子系统的方式运行了一个完整的 Linux 系统。使得在 Windows 中使用 Linux 中的工具链成为可能。(Windows 果然是最好的 Linux 发行版)</p>

<p>从微软宣布 WSL 的第一天起，我就一直在关注这项技术。因为我虽然通过双系统的方式安装了 Ubuntu，但切换系统需要从启的机制确实不方便，让我离开 Windows 又实在是不太现实。 (学习的原因，离不开 Visual Studio 和 Adobe 全家桶) WSL 似乎是平衡性能和易用性的最好解决方案了。怎奈何 WSL 只支持 64 位的系统，让我这台老电脑很是尴尬。</p>

<p>如今换电脑了！终于可以享受 WSL 的便利了！！ (*^▽^*)</p>

<p>第一次使用时，<strong>如果发现没有 WSL 中没有网络连接，可以试着重启一下 WSL，还是没网重启一下 Windows</strong></p>

<!-- more -->

<h1 id="安装">安装</h1>

<p>用<strong>管理员权限</strong>打开 PowerShell 并运行下面的命令</p>

<pre><code class="language-shell">Enable-WindowsOptionalFeature -Online -FeatureName Microsoft-Windows-Subsystem-Linux
</code></pre>

<p><strong>或者：</strong>控制面板 -&gt; 程序和功能-&gt; 启用或关闭 Windows 功能 -&gt; 勾选 <code>适用于 Linux 的 Windows 子系统</code>
<img alt="安装 WSL" src="https://mogeko.github.io/images/016/install_1.png"></p>

<p>重启电脑</p>

<p>打开应用商城，搜索：<code>WSL</code>，可根据需求选择安装一个或多个 Linux 系统
<img alt="安装 WSL" src="https://mogeko.github.io/images/016/install_2.png"></p>

<p>安装完成后再开始菜单中启动。
第一次启动会需要初始化，需要配置一段时间。
<img alt="初始化" src="https://mogeko.github.io/images/016/init_1.png">
配置结束后会让你输入用户名和 root 密码 (输入 root 密码时没有显示是正常的；root 密码请务必牢记)
<img alt="初始化" src="https://mogeko.github.io/images/016/init_2.png">
然后就可以使用了！</p>

<h1 id="使用-wsl">使用 WSL</h1>

<h2 id="启动">启动</h2>

<p>你可以通过以下方式<strong>启动 WSL</strong></p>

<ul>
<li>通过<code>开始菜单</code>启动</li>
<li>打开 cmd 或者 <code>Win + R</code> 输入： <code>wsl</code> 或者 <code>bash</code></li>
<li>打开 cmd 或者 <code>Win + R</code> 输入： <code>wsl [command]</code> 或者 <code>bash -c [command]</code></li>
<li>打开 cmd 或者 <code>Win + R</code> 输入： [Linux系统名称]（如：ubuntu），这跟上面在开始菜单里启动是一样的</li>
</ul>

<p>其中，前两种方式会运行默认的 Linux 系统，当你安装多个 Linux 系统之后可以使用 <code>wslconfig</code> 来指定默认的 Linux 系统。</p>

<h2 id="换源">换源</h2>

<h3 id="更换-apt-源">更换 apt 源</h3>

<p>因为 Ubuntu 的官方源架在国外的服务器上的，国内使用官方源下软件就会很慢。我们可以通过将软件源换成国内的镜像源来解决这个问题。
首先备份</p>

<pre><code class="language-shell">cp /etc/apt/sources.list /etc/apt/sources.list.bak
</code></pre>

<p>然后换源，这里我推荐使用清华大学的镜像源
首先使用 vim 打开文件 <code>sources.list</code> (需要 root 权限) -&gt; <a href="http://www.runoob.com/linux/linux-vim.html" rel="nofollow noreferrer" target="_blank">vim 教程</a></p>

<pre><code class="language-shell">vim /etc/apt/sources.list
</code></pre>

<p>删除掉所有内容，然后将以下文本粘贴上去</p>

<pre><code class="language-shell"># 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-updates main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-backports main restricted universe multiverse
deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-security main restricted universe multiverse

# 预发布软件源，不建议启用
# deb https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
# deb-src https://mirrors.tuna.tsinghua.edu.cn/ubuntu/ bionic-proposed main restricted universe multiverse
</code></pre>

<p>执行 <code>:wq</code> 保存并退出 vim，然后执行以下命令更新一下软件包列表。</p>

<pre><code class="language-shell">sudo apt update
</code></pre>

<p>一般情况下，会有软件需要更新，使用以下命令更新软件包 (可选)</p>

<pre><code class="language-shell">sudo apt upgrage
</code></pre>

<h3 id="更换-pip-源">更换 pip 源</h3>

<p>创建pip配置文件</p>

<pre><code class="language-shell">mkdir ~/.pip &amp;&amp; touch ~/.pip/pip.conf
</code></pre>

<p>首先使用 vim 打开文件 <code>pip.conf</code></p>

<pre><code class="language-shell">vim ~/.pip/pip.conf
</code></pre>

<p>以下文本粘贴上去，并保存</p>

<pre><code class="language-shell">[global]
index-url = https://pypi.tuna.tsinghua.edu.cn/simple
</code></pre>

<h2 id="安装-zsh">安装 zsh</h2>

<p>zsh 是 Linux 下最强大的shell。虽然大多数 Linux 发行版都默认使用<code>bash shell</code>, 但是丝毫不影响极客们对zsh的热衷。很多 Linux 发行版都包含有 zsh，就算没有，也可以很简单的通过 <code>apt</code> 、urpmi<code>或</code>yum` 等包管理器进行安装。</p>

<p>Zsh具有以下主要功能：</p>

<ul>
<li>开箱即用、可编程的命令行补全功能可以帮助用户输入各种参数以及选项</li>
<li>在用户启动的所有 shell 中共享命令历史</li>
<li>通过扩展的文件通配符，可以不利用外部命令达到 <code>find</code> 命令一般展开文件名</li>
<li>改进的变量与数组处理</li>
<li>在缓冲区中编辑多行命令</li>
<li>多种兼容模式，例如使用 <code>/bin/sh</code> 运行时可以伪装成 Bourne shell</li>
<li>可以定制呈现形式的提示符；包括在屏幕右端显示信息，并在键入长命令时自动隐藏</li>
<li>可加载的模块，提供其他各种支持：完整的 TCP 与 Unix 域套接字控制，FTP 客户端与扩充过的数学函数</li>
<li>完全可定制化</li>
</ul>

<p><a href="https://www.zhihu.com/question/21418449" rel="nofollow noreferrer" target="_blank">为什么说 zsh 是 shell 中的极品？</a></p>

<p>在 Ubuntu 中，我们使用 <code>apt</code> 来安装 zsh (需要 root 权限)</p>

<pre><code class="language-shell">sudo apt install
</code></pre>

<h3 id="安装-oh-my-zsh">安装 oh-my-zsh</h3>

<p><code>oh-my-zsh</code> 是 zsh 中最流行的配色方案，十分养眼。</p>

<p>安装也十分简单，可以直接使用如下命令进行安装</p>

<pre><code class="language-shell">sh -c &quot;$(curl -fsSL https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh)&quot;
</code></pre>

<h3 id="将-zsh-设置成-linux-系统的默认-shell">将 zsh 设置成 Linux 系统的默认 Shell</h3>

<p>依然先备份</p>

<pre><code class="language-shell">cp ~/.bashrc ~/.bashrc.bak
</code></pre>

<p>然后使用 vim 打开文件 <code>.bashrc</code></p>

<pre><code class="language-shell">vim ~/.bashrc
</code></pre>

<p>删除掉所有内容，然后将以下文本粘贴上去，并保存</p>

<pre><code class="language-shell">if [ -t 1 ]; then
exec zsh
fi
</code></pre>

<p>更新 .bashrc</p>

<pre><code class="language-shell">source ~/.bashrc
</code></pre>

<p>重启 WSL，就可以看到漂亮的 zsh 了！！</p>

<h1 id="配置">配置</h1>

<h2 id="wslconfig-相关设置">wslconfig 相关设置</h2>

<p>在 <code>bash</code>、<code>cmd</code>、<code>PowerShell</code> 中使用以下命令对 WSL 进行配置。
设置默认的 Linux 系统</p>

<pre><code class="language-shell">wslconfig /setdefault [DistributionName]
</code></pre>

<p>卸载 Linux 系统</p>

<pre><code class="language-shell">wslconfig /unregister [DistributionName]
</code></pre>

<p>查看已安装的linux系统</p>

<pre><code class="language-shell">wslconfig /list
</code></pre>

<h2 id="ubuntu-相关设置">Ubuntu 相关设置</h2>

<p>设置默认登陆用户 (默认为第一次运行时输入的用户名)</p>

<pre><code class="language-shell">ubuntu config --default-user root
</code></pre>

<h2 id="vim-相关配置">vim 相关配置</h2>

<p>vim 使用配置文件 <code>~/.vimrc</code> 进行配置。这里是我个人使用的 <a href="https://gist.github.com/291effaf70cce916ce8b1c2a964fcc0d" rel="nofollow noreferrer" target="_blank">vim 配置</a>，欢迎 <code>clone</code>
我也写了个配置脚本，执行以下命令可以自动完成大部分配置</p>

<pre><code class="language-shell">wget https://gist.githubusercontent.com/Mogeko/291effaf70cce916ce8b1c2a964fcc0d/raw/2dd5167e0af890c3a3f636a960befe53e7ab8f57/Install.sh &amp;&amp; chmod +x Install.sh &amp;&amp;./Install.sh &amp;&amp; rm Install.sh
</code></pre>

<p>执行完后输入 <code>vim</code> 打开 vim，然后输入命令 <code>:PlugInstall</code> 安装插件。</p>

    </div>

    <div class="post-copyright">
             
            <p class="copyright-item">
                <span>Author:</span>
                <span>Mogeko </span>
                </p>
            
           
             
            <p class="copyright-item">
                    <span>Link:</span>
                    <a href=https://mogeko.me/2018/016/>https://mogeko.me/2018/016/</span>
            </p>
            
             
            <p class="copyright-item lincese">
                本文采用<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>进行许可
            </p>
            
    </div>

  
    <div class="post-tags">
        
            <section>
            <i class="iconfont icon-tag"></i>Tag(s): 
            
            <span class="tag"><a href="https://mogeko.me/tags/gnu/linux/">
                    #GNU/Linux</a></span>
            
            <span class="tag"><a href="https://mogeko.me/tags/ubuntu/">
                    #Ubuntu</a></span>
            
            <span class="tag"><a href="https://mogeko.me/tags/windows/">
                    #Windows</a></span>
            
            </section>
        
        <section>
                <a href="javascript:window.history.back();">back</a></span> · 
                <span><a href="https://mogeko.me">home</a></span>
        </section>
    </div>

    <div class="post-nav">
        
        <a href="https://mogeko.me/2018/015/" class="prev" rel="prev" title="使用 Android 手机搭建 KMS 激活服务器"><i class="iconfont icon-left"></i>&nbsp;使用 Android 手机搭建 KMS 激活服务器</a>
         
        
        <a href="https://mogeko.me/2018/017/" class="next" rel="next" title="本地搭建 KMS 激活服务">本地搭建 KMS 激活服务&nbsp;<i class="iconfont icon-right"></i></a>
        
    </div>

    <div class="post-comment">
          
                 
          
        
<div id="gitalk-container"></div>
<link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
<script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
<script>
    const gitalk = new Gitalk({
        clientID: '936cecdd2ab935870ca5',
        clientSecret: '39cfc7a3cb9a974b6609f3fdaa637e2917e3e40a',
        repo: 'Blog',
        owner: 'Mogeko',
        admin: ['Mogeko'],
        id: location.pathname, 
        distractionFreeMode: false 
    });
    (function () {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('gitalk-container').innerHTML = 'Gitalk comments not available by default when the website is previewed locally.';
            return;
        }
        gitalk.render('gitalk-container');
    })();
</script>

    </div>
</article>
          </div>
		   </main>
      <footer class="footer">
    <div class="copyright">
        &copy;
        
        <span itemprop="copyrightYear">2017 - 2019</span>
        
        <span class="with-love">
    	 <i class="iconfont icon-love"></i> 
         </span>
         
            <span class="author" itemprop="copyrightHolder"><a href="https://mogeko.me">Mogeko</a> | </span> 
         

         
		  <span>Powered by <a href="https://gohugo.io/" target="_blank" rel="external nofollow">Hugo</a> & <a href="https://github.com/liuzc/leaveit" target="_blank" rel="external nofollow">LeaveIt</a></span> 
    </div>
</footer>












    
     <link href="//lib.baomitu.com/lightgallery/1.6.11/css/lightgallery.min.css" rel="stylesheet">  
      
     <script src="/js/vendor_gallery.min.js" async="" ></script>
    
  



     </div>
  </body>
</html>
